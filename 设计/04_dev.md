

# Dev / AI Execution Spec

## 个人健康数据系统 3.0 — MVP（修订版 v1.1）

> 面向对象：开发人员 / AI 执行工具
> 本文档用于指导**最小可运行闭环**的实现
> **严格约束执行顺序，不允许跳步**

---

## 0. 执行总原则（必须先读）

> **所有后续处理，必须以 LLM 解析后的 JSON 结构为唯一输入。**
> 不允许直接从 md 文件进入分析或展示。

这是 3.0 架构的**核心约束之一**。

---

## 1. 本阶段执行目标（Execution Goal）

### 唯一目标

> **使用 LLM 将 md 健康数据文件解析为统一 JSON 结构，
> 并基于该 JSON 生成可视化图像。**

成功标准不是“图画得多漂亮”，而是：

* JSON 结构稳定
* JSON → 图像路径跑通
* md 本身不再被直接消费

---

## 2. MVP 范围定义（Scope）

### In Scope（必须完成）

1. md 文件输入
2. 使用 LLM 进行语义解析
3. 生成标准化指标型 JSON
4. 基于 JSON 构建时间序列
5. 单一指标趋势可视化

---

### Out of Scope（明确不做）

* 不绕过 LLM 直接解析 md
* 不在本阶段引入人工规则解析
* 不处理非 md 文件
* 不做多指标分析
* 不做医疗判断
* 不做长期数据库治理

> ⚠️ **任何“为了方便直接解析 md”的行为，均视为违规。**

---

## 3. Step 1：md → LLM → JSON（核心步骤）

### 3.1 输入约定（md）

* md 内容来源于 2.0 阶段
* md 可能包含：

  * 检查时间
  * 指标名称
  * 数值
  * 单位
  * 备注文本

### 3.2 LLM 的职责（非常重要）

LLM 的唯一职责是：

> **将 md 中的健康信息，解析为“指标导向”的结构化 JSON。**

LLM **不负责**：

* 判断健康好坏
* 补全缺失数据
* 推断医学结论

---

### 3.3 JSON 输出要求（最低标准）

JSON 至少应包含以下字段（示意）：

```json
{
  "source": "md",
  "records": [
    {
      "metric": "blood_pressure_systolic",
      "value": 128,
      "unit": "mmHg",
      "measured_at": "2025-12-14"
    }
  ]
}
```

说明：

* 字段命名不要求一次定死
* 允许字段缺失
* JSON 是**分析级中间态，不是事实源**

---

## 4. Step 2：JSON → 时间序列构建

### 原则

* 只消费 LLM 输出的 JSON
* 不回读 md
* 不混用数据来源

### 目标

* 按指标聚合
* 按时间排序
* 形成基础时间序列结构

---

## 5. Step 3：基础趋势分析（最小）

### 分析范围

* 单一指标
* 时间序列趋势

### 输出内容

* 趋势方向（描述性）
* 简单变化范围

### 明确禁止

* 医疗结论
* 风险判断
* 复杂模型

---

## 6. Step 4：可视化输出

### 必须输出

* 至少一张基于时间序列的图表
* 横轴：时间
* 纵轴：指标值

### 可选输出

* 简短趋势描述文本

---

## 7. 数据存储约定（当前阶段）

* JSON 可临时存储
* 时间序列可临时存储
* 不要求最终数据库设计

> **数据库不是本阶段的核心交付物。**

---

## 8. 禁止事项（Hard Constraints）

以下行为一律禁止：

* 绕过 LLM 解析 md
* 直接对 md 做分析
* 为了 UI 改变 JSON 结构语义
* 将分析结果写回 md

---

## 9. 完成定义（Definition of Done）

当满足以下条件，即视为 MVP 完成：

1. 任意 md 文件可通过 LLM 生成 JSON
2. JSON 结构可被程序稳定消费
3. 基于 JSON 可生成时间序列图像
4. 无医疗诊断性输出

---

## 10. 给执行者的一句话说明

> **你做的第一件事永远是：
> 把 md 交给 LLM，拿回 JSON。
> 之后的一切，都不再碰 md。**




