

# 个人健康数据系统 3.0

## Architect Design Review Version

---

## 1. 背景与问题定义（Context & Problem）

### 1.1 背景

在 1.0 阶段，系统完成了个人健康数据的采集与留存；
在 2.0 阶段，系统完成了对原始健康数据的预处理、语义化与初步结构化，形成了可复用的数据资产。

当前面临的问题是：

* 健康数据来源分散、结构异构
* 单条数据本身意义有限，长期趋势价值尚未被释放
* 数据尚不能被稳定地用于分析、展示与沟通

---

### 1.2 本阶段要解决的核心问题

**3.0 阶段只解决一个问题：**

> 如何将已语义化的健康数据，转化为
> **可查询、可分析、可解释的时间序列数据，并以直观方式表达出来。**

---

## 2. 系统目标与非目标（Goals & Non-Goals）

### 2.1 目标（Goals）

* 将分散的健康数据转化为结构化时间序列
* 支持基础统计分析与趋势识别
* 支持多指标组合与风险信号压缩
* 自动生成图表与健康管理报告
* 为后续模型与专业协作提供稳定数据基础

---

### 2.2 非目标（Non-Goals）

3.0 阶段**刻意不追求**：

* 医疗诊断结论
* 疾病级建模
* 完整医学知识图谱
* 单次分析结果的结论化
* 医疗合规与责任系统

---

## 3. 系统整体架构定位（High-Level Architecture）

### 3.1 架构定位

3.0 是一个**数据收敛、分析与表达层**，位于系统中游：

* 下游：不影响 2.0 数据资产形态
* 上游：为展示、报告与专业使用提供结构化输出

---

### 3.2 总体工作流

系统采用单向、可回溯的数据处理流水线：

1. 健康数据按指标域分类建表
2. 原始数据经 LLM 解析为标准化 JSON
3. JSON 数据写入对应指标表，形成时间序列
4. 单一指标进行趋势与稳定性分析
5. 多指标组合计算派生指标与风险信号
6. 多指标间进行相关性分析
7. 生成图表用于理解与验证
8. 自动生成患者版与医生版报告

---

## 4. 核心架构决策（Architectural Decisions）

### AD-1：按“健康指标”而非“医疗对象”建模

**决策**
系统以长期稳定的健康指标作为核心数据单位。

**原因**

* 指标天然支持时间序列分析
* 医疗对象高度依赖专业判断，不适合在 MVP 阶段冻结

**影响**

* 系统聚焦趋势而非诊断
* 架构对未来模型具有更高兼容性

---

### AD-2：明确区分数据的生命周期形态

系统中存在以下数据形态：

1. 原始数据（文件 / md / 图片）
2. 解析中间态（LLM JSON）
3. 分析态（指标时间序列）
4. 表达态（图表 / 报告）

**原则**

* 原始数据永不覆盖
* 中间态不等同于事实
* 分析结果可重算、可丢弃

---

### AD-3：人工备注与正式检查数据分通道处理

* 正式检查数据 → 参与分析与统计
* 人工标注 / 备注 → 作为解释性上下文存在

目的在于避免主观信息被误用为客观计算输入。

---

### AD-4：分析能力作为可替换模块存在

3.0 只定义分析的输入与输出结构，不绑定：

* 分析语言
* 算法实现
* 计算框架

分析被视为“服务能力”，而非系统核心资产。

---

### AD-5：分析结果与展示方式解耦

* 系统保证输出结果结构化、可消费
* 图表与前端实现不作为 3.0 固定内容

---

### **AD-6：数据访问与持久化边界（Data Access Boundary）**

**决策**
系统中的持久化数据（包括指标时间序列及其派生存储）
**不作为共享资源直接暴露给业务逻辑或分析模块**。
所有数据库访问必须通过**受控的数据访问 API / 库**完成。

**原因**

* 数据是系统的长期资产，必须保持主权边界
* 直接操作数据库会导致分析逻辑与存储强耦合
* 不利于后续数据结构演进与重算能力

**原则**

* 数据库 Schema 可演进，访问 API 是稳定边界
* 业务层、分析层不得直接操作表结构
* 不允许跨层直接读写数据库

**影响**

* 数据访问方式被显性治理
* 技术实现必须围绕数据访问库展开
* 为后续替换 ORM、迁移存储提供空间

---

## 5. 数据设计与数据形态（Data Design）

### 5.1 数据类型划分

* 原始数据：检查报告、文件、图片
* 解析数据：LLM 输出的指标型 JSON
* 分析数据：指标时间序列表
* 表达数据：图表、报告、摘要信息

---

### 5.2 数据生命周期与转换关系

原始数据
→ 语义解析（LLM）
→ 指标化结构数据
→ 统计分析结果
→ 可视化与报告输出

---

### 5.3 数据来源差异处理原则

* 报告数据：可信度高，进入分析流程
* 人工输入：可信度依赖语境，仅用于解释
* 派生数据：标注为计算结果，非原始事实

---

## 6. 分析与计算策略（Analysis Strategy）

### 6.1 分析角色定位

分析用于：

* 描述趋势
* 压缩复杂信息
* 辅助理解与沟通

不用于给出医疗结论。

---

### 6.2 分析输入与输出

* 输入：标准化的指标时间序列
* 输出：统计结果、趋势描述、派生指标

---

### 6.3 实现策略（非绑定）

* 可使用 Python / pandas 等成熟工具
* 实现方式不影响整体架构
* 具体实现可由 AI 辅助生成

---

## 7. 展示与消费方式（Presentation）

### 7.1 展示目标

* 帮助用户理解自身健康趋势
* 帮助专业人员快速把握关键信息

---

### 7.2 解耦原则

* 同一分析结果可用于多端展示
* 前端与展示方案可在后续阶段演进

---

## 8. 风险、限制与假设（Risks & Assumptions）

### 8.1 当前阶段接受的风险

* 数据不完整
* 解析误差
* 模型简化

---

### 8.2 关键假设

* 健康数据可长期积累
* 分析结果仅用于辅助决策

---

## 9. 演进路径（Roadmap）

* 4.0 可引入更复杂的模型与专业协作
* 在数据路径验证正确后再评估医学复杂性
* 展示组件可逐步平台化

---

## 10. 执行与协作说明（Execution Notes）

* 架构决策不可随意更改
* 实现细节可交由 AI 或执行层完成
* 分析与展示模块保持可替换性


